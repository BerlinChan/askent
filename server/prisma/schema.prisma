// Prisma Schema Language (PSL)
// https://github.com/prisma/prisma2/blob/master/docs/prisma-schema-file.md
// https://github.com/prisma/specs/tree/master/schema

datasource db {
  provider = "sqlite"
  url      = "file:dev.db"
  enabled  = true
}

generator photon {
  provider = "photonjs"
}

model User {
  id          String     @default(cuid()) @id
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  lastLoginAt DateTime?
  role        Role       @default(Admin)
  name        String?    @unique
  email       String?    @unique
  fingerprint String?    @unique
  password    String?
  events      Event[]
  questions   Question[]
}

enum Role {
  Admin
  Audience
  Guest
}

model Event {
  id         String     @default(uuid()) @id
  code       String     @unique
  name       String
  owner      User
  audiences  User[]     @relation(name: "EventAudiencesToUserTable")
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  startAt    DateTime
  endAt      DateTime
  questions  Question[]
  moderation Boolean    @default(false)
}

model Question {
  id         String   @default(uuid()) @id
  event      Event
  author     User?
  username   String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  content    String
  votedUsers User[]   @relation(name: "VotedUsersUserTable")
  star       Boolean  @default(false)
  archived   Boolean  @default(false)
  published  Boolean  @default(true)
  top        Boolean  @default(false)
}