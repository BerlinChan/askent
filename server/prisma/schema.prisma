// Prisma Schema Language (PSL)
// https://github.com/prisma/prisma2/blob/master/docs/prisma-schema-file.md
// https://github.com/prisma/specs/tree/master/schema

datasource db {
  provider = "sqlite"
  url      = "file:dev.db"
  enabled  = true
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id             String     @default(cuid()) @id
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  lastLoginAt    DateTime?
  roles          Role[]
  name           String?
  email          String?    @unique
  fingerprint    String?    @unique
  password       String?
  events         Event[]
  questions      Question[]
  votedQuestions Question[] @relation(name: "VotedUsersUserTable")
}

model Role {
  id    String   @default(cuid()) @id
  name  RoleName @unique
  users User[]
}

enum RoleName {
  ADMIN
  AUDIENCE
  WALL
}

model Event {
  id         String     @default(cuid()) @id
  code       String     @unique
  name       String
  owner      User
  audiences  User[]     @relation(name: "EventAudiencesUserTable")
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  startAt    DateTime
  endAt      DateTime
  questions  Question[]
  moderation Boolean    @default(false)
}

model Question {
  id           String               @default(cuid()) @id
  event        Event
  author       User
  createdAt    DateTime             @default(now())
  updatedAt    DateTime             @updatedAt
  content      String
  votedUsers   User[]               @relation(name: "VotedUsersUserTable")
  reviewStatus QuestionReviewStatus @default(PUBLISH)
  star         Boolean              @default(false)
  top          Boolean              @default(false)
}

enum QuestionReviewStatus {
  REVIEW
  PUBLISH
  ARCHIVE
}